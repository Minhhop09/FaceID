<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ªØ li·ªáu ƒë√£ x√≥a - FaceID System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary:#4361ee;--primary-dark:#3a56d4;--secondary:#6c757d;
            --success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;
            --light:#f8f9fa;--dark:#343a40;--sidebar-bg:#1e293b;
            --sidebar-hover:#334155;--sidebar-active:#4361ee;
        }
        body {
            background:linear-gradient(135deg,#f5f7fa 0%,#e4edf5 100%);
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            min-height:100vh;overflow-x:hidden;
        }
        .sidebar{min-height:100vh;width:280px;background:var(--sidebar-bg);position:fixed;top:0;left:0;z-index:1000;transition:all .3s ease;box-shadow:3px 0 15px rgba(0,0,0,.1);}
        .sidebar-header{padding:25px 20px;border-bottom:1px solid rgba(255,255,255,.1);text-align:center;}
        .sidebar-brand{color:#fff;text-decoration:none;font-size:1.5rem;font-weight:700;display:flex;align-items:center;justify-content:center;gap:10px;}
        .sidebar-brand i{background:linear-gradient(135deg,var(--primary),#4895ef);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:1.8rem;}
        .sidebar-nav{padding:20px 0 80px;overflow-y:auto;height:calc(100vh - 80px);}
        .nav-item{margin-bottom:5px;}
        .nav-link{color:rgba(255,255,255,.8);padding:15px 25px;text-decoration:none;display:flex;align-items:center;gap:12px;transition:all .3s ease;border-left:3px solid transparent;font-weight:500;}
        .nav-link:hover{color:#fff;background:var(--sidebar-hover);border-left-color:var(--primary);transform:translateX(5px);}
        .nav-link.active{color:#fff;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-left-color:#fff;box-shadow:0 4px 15px rgba(67,97,238,.3);}
        .nav-link i{width:20px;text-align:center;font-size:1.1rem;}
        .logout-link{color:#f8d7da;border-top:1px solid rgba(255,255,255,.1);margin-top:20px;}
        .logout-link:hover{color:#dc3545;background:rgba(220,53,69,.1);}
        .main-content{margin-left:280px;padding:30px;transition:all .3s ease;}
        .dashboard-header{background:#fff;border-radius:15px;padding:25px 30px;margin-bottom:30px;box-shadow:0 5px 15px rgba(0,0,0,.08);display:flex;justify-content:space-between;align-items:center;}
        .header-title h1{color:var(--dark);font-weight:700;margin-bottom:5px;}
        .header-title p{color:var(--secondary);margin:0;}
        .user-profile{display:flex;align-items:center;gap:15px;background:var(--light);padding:12px 20px;border-radius:12px;border:1px solid rgba(0,0,0,.05);}
        .user-avatar{width:45px;height:45px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:1.2rem;}
        .user-info{line-height:1.4;}
        .user-name{font-weight:600;color:var(--dark);margin:0;}
        .user-role{color:var(--secondary);font-size:.9rem;margin:0;}
        .tab-content{background:#fff;border-radius:15px;padding:30px;box-shadow:0 5px 15px rgba(0,0,0,.08);animation:fadeInUp .6s ease-out;}
        .nav-tabs {
    border-bottom: 2px solid #e9ecef;
    margin-bottom: 25px;
    flex-wrap: nowrap; /* NgƒÉn xu·ªëng d√≤ng */
    overflow-x: auto; /* Cho ph√©p cu·ªôn ngang n·∫øu c·∫ßn */
}

.nav-tabs .nav-link {
    color: var(--secondary);
    background: none;
    border: none;
    padding: 12px 20px; /* Gi·∫£m padding ngang */
    font-weight: 500;
    border-radius: 8px 8px 0 0;
    margin-bottom: -2px;
    white-space: nowrap; /* Quan tr·ªçng: ngƒÉn ch·ªØ xu·ªëng d√≤ng */
}

.nav-tabs .nav-link i {
    margin-right: 0.4rem; /* Gi·∫£m kho·∫£ng c√°ch icon */
}

.nav-tabs .nav-link:hover {
    color: var(--primary);
    background: rgba(67,97,238,.05);
    border: none;
}

.nav-tabs .nav-link.active {
    color: var(--primary);
    background: #fff;
    border-bottom: 2px solid var(--primary);
    font-weight: 600;
}
        .table-container{overflow-x:auto;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.05);}
        .table th{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;font-weight:600;padding:15px;text-align:center;border:none;}
        .table td{padding:15px;vertical-align:middle;border-bottom:1px solid #e9ecef;}
        .table tbody tr:hover{background-color:rgba(67,97,238,.03);}
        .empty-state{text-align:center;padding:60px 20px;background:var(--light);border-radius:15px;}
        .empty-icon{font-size:4rem;color:var(--secondary);margin-bottom:20px;}
        .empty-title{color:var(--dark);margin-bottom:10px;}
        .empty-text{color:var(--secondary);max-width:400px;margin:0 auto 25px;}
        .btn-primary{background:linear-gradient(135deg,var(--primary),var(--primary-dark));border:none;border-radius:8px;padding:12px 24px;font-weight:500;transition:all .3s;}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(67,97,238,.3);}
        .btn-success{background:linear-gradient(135deg,var(--success),#20c374);border:none;border-radius:8px;padding:8px 16px;font-weight:500;transition:all .3s;}
        .btn-success:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(40,167,69,.3);}
        .badge{font-size:.85rem;padding:6px 12px;border-radius:20px;}
        .badge-secondary{background:rgba(108,117,125,.1);color:var(--secondary);}
        .badge-success{background:rgba(40,167,69,.1);color:var(--success);}
        .badge-warning{background:rgba(255,193,7,.1);color:var(--warning);}
        @keyframes fadeInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
        @media(max-width:992px){.sidebar{width:80px;}.sidebar-brand span,.nav-link span{display:none;}.main-content{margin-left:80px;}.sidebar-header{padding:20px 10px;}.nav-link{justify-content:center;padding:15px;}.nav-link i{font-size:1.3rem;}}
        @media(max-width:768px){.main-content{padding:20px;}.dashboard-header{flex-direction:column;gap:15px;text-align:center;}.table-container{font-size:.9rem;}.nav-tabs .nav-link{padding:10px 16px;font-size:.9rem;}}
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <a href="#" class="sidebar-brand"><i class="fas fa-id-card-alt"></i><span>FaceID System</span></a>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-item"><a href="{{ url_for('admin_dashboard') }}" class="nav-link"><i class="fas fa-home"></i><span>Trang ch·ªß</span></a></div>
            <div class="nav-item"><a href="{{ url_for('employee_bp.employee_list') }}" class="nav-link"><i class="fas fa-users"></i><span>Qu·∫£n l√Ω nh√¢n vi√™n</span></a></div>
            <div class="nav-item"><a href="{{ url_for('department_bp.departments') }}" class="nav-link"><i class="fas fa-building"></i><span>Ph√≤ng ban</span></a></div>
            <div class="nav-item"><a href="{{ url_for('shift_bp.shifts') }}" class="nav-link"><i class="fas fa-clock"></i><span>Ca l√†m vi·ªác</span></a></div>
            <div class="nav-item"><a href="{{ url_for('schedule_bp.assigned_employees') }}" class="nav-link"><i class="fas fa-calendar-check"></i><span>Ph√¢n ca</span></a></div>
            <div class="nav-item"><a href="{{ url_for('attendance_bp.attendance_report') }}" class="nav-link"><i class="fas fa-chart-line"></i><span>Ch·∫•m c√¥ng</span></a></div>
            <div class="nav-item"><a href="{{ url_for('salary_bp.salary_view') }}" class="nav-link"><i class="fas fa-coins"></i><span>T√≠nh l∆∞∆°ng</span></a></div>
            <div class="nav-item"><a href="{{ url_for('account_bp.accounts') }}" class="nav-link"><i class="fas fa-user-gear"></i><span>T√†i kho·∫£n</span></a></div>
            <div class="nav-item"><a href="{{ url_for('faces_bp.faces') }}" class="nav-link"><i class="fas fa-id-card"></i><span>Khu√¥n m·∫∑t nh√¢n vi√™n</span></a></div>
            <div class="nav-item"><a href="{{ url_for('reports_bp.reports_view') }}" class="nav-link"><i class="fas fa-chart-bar"></i><span>B√°o c√°o th·ªëng k√™</span></a></div>
            <div class="nav-item"><a href="{{ url_for('employee_bp.employee_list_deleted') }}" class="nav-link active"><i class="fas fa-trash"></i><span>D·ªØ li·ªáu ƒë√£ x√≥a</span></a></div>
            <div class="nav-item"><a href="{{ url_for('history_bp.history') }}" class="nav-link"><i class="fas fa-history"></i><span>L·ªãch s·ª≠ thay ƒë·ªïi</span></a></div>
            <div class="nav-item"><a href="{{ url_for('auth_bp.login') }}" class="nav-link logout-link"><i class="fas fa-right-from-bracket"></i><span>ƒêƒÉng xu·∫•t</span></a></div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="dashboard-header">
            <div class="header-title">
                <h1>D·ªØ li·ªáu ƒë√£ x√≥a</h1>
                <p>Xem v√† kh√¥i ph·ª•c c√°c ƒë·ªëi t∆∞·ª£ng ƒë√£ b·ªã x√≥a kh·ªèi h·ªá th·ªëng</p>
            </div>
            <div class="user-profile">
                <div class="user-avatar">{{ session['username'][0]|upper }}</div>
                <div class="user-info">
                    <div class="user-name">{{ session['username'] }}</div>
                    <div class="user-role">{{ session['role'] }}</div>
                </div>
            </div>
        </div>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show mb-4" role="alert">
                        <i class="fa-solid fa-{{ 'triangle-exclamation' if category == 'error' else 'circle-check' }} me-2"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="deletedTabs">
    <!-- Nh√¢n vi√™n -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'employees' %}active{% endif %}" href="{{ url_for('employee_bp.employee_list_deleted') }}">
                    <i class="fas fa-users me-2"></i>Nh√¢n vi√™n
                </a>
            </li>

            <!-- Ph√≤ng ban -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'departments' %}active{% endif %}" href="{{ url_for('department_bp.deleted_departments_list') }}">
                    <i class="fas fa-building me-2"></i>Ph√≤ng ban
                </a>
            </li>

            <!-- Ca l√†m vi·ªác -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'shifts' %}active{% endif %}" href="{{ url_for('shift_bp.deleted_shifts') }}">
                    <i class="fas fa-clock me-2"></i>Ca l√†m vi·ªác
                </a>
            </li>

            <!-- Ph√¢n ca -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'shift_assignments' %}active{% endif %}"
                href="{{ url_for('schedule_bp.deleted_shift_assignments_list') }}">
                    <i class="fas fa-calendar-check me-2"></i>Ph√¢n ca
                </a>
            </li>

            <!-- T√†i kho·∫£n -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'accounts' %}active{% endif %}" href="{{ url_for('account_bp.deleted_accounts_list', tab='accounts') }}"
>
                    <i class="fas fa-user-gear me-2"></i>T√†i kho·∫£n
                </a>
            </li>

            <!-- Ch·∫•m c√¥ng -->
            <li class="nav-item">
                <a class="nav-link {% if active_tab == 'attendance' %}active{% endif %}" href="{{ url_for('attendance_bp.deleted_attendance', tab='attendance') }}">

                    <i class="fas fa-fingerprint me-2"></i>Ch·∫•m c√¥ng
                </a>
            </li>

            <!-- L∆∞∆°ng -->
            <li class="nav-item">
    <a class="nav-link {% if active_tab == 'salary' %}active{% endif %}"
       href="{{ url_for('salary_bp.deleted_salaries') }}">
        <i class="fas fa-money-bill-wave me-2"></i>L∆∞∆°ng
    </a>
</li>

            <li class="nav-item">
    <a class="nav-link {% if active_tab == 'faces' %}active{% endif %}"
       href="{{ url_for('faces_bp.deleted_faces', tab='faces') }}"
>
        <i class="fas fa-face-smile me-1"></i> Khu√¥n m·∫∑t
    </a>
</li>



        </ul>


        <div class="tab-content">
<!-- ================= TAB NH√ÇN VI√äN ================= -->
{% if active_tab == 'employees' %}
<div class="tab-pane fade show active">
    {% if deleted_employees %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0"><i class="fas fa-user-slash text-danger me-2"></i>Nh√¢n vi√™n ƒë√£ x√≥a</h4>
            <p class="text-muted mb-0 mt-1">T·ªïng c·ªông: {{ deleted_employees|length }} nh√¢n vi√™n</p>
        </div>
        <a href="{{ url_for('employee_bp.employee_list') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch nh√¢n vi√™n
        </a>
    </div>

    <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu nh√¢n vi√™n -->
    <form method="POST" action="{{ url_for('employee_bp.restore_selected_employees') }}">
        <div class="table-container">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" id="select-all-employees" class="form-check-input">
                        </th>
                        <th>·∫¢nh</th>
                        <th>M√£ NV</th>
                        <th>H·ªç t√™n</th>
                        <th>Email</th>
                        <th>Ch·ª©c v·ª•</th>
                        <th>Ph√≤ng ban</th>
                        <th class="text-center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    {% for nv in deleted_employees %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_employees" value="{{ nv.MaNV }}" class="form-check-input employee-checkbox">
                        </td>

                        <!-- ‚úÖ C·ªôt ·∫£nh -->
                        <td class="text-center">
    {% if nv.DuongDanAnh %}
        <img src="/photos/{{ nv.DuongDanAnh|replace('photos/', '') }}"
             alt="·∫¢nh nh√¢n vi√™n"
             class="rounded-circle border shadow-sm"
             style="width:40px; height:40px; object-fit:cover; transition:transform 0.2s;"
             onmouseover="this.style.transform='scale(1.3)'"
             onmouseout="this.style.transform='scale(1)'">
    {% else %}
        <img src="{{ url_for('static', filename='images/no_image.png') }}"
             alt="Kh√¥ng c√≥ ·∫£nh"
             class="rounded-circle border shadow-sm"
             style="width:40px; height:40px; object-fit:cover;">
    {% endif %}
</td>


                        <td class="fw-bold">{{ nv.MaNV }}</td>
                        <td>{{ nv.HoTen }}</td>
                        <td>{{ nv.Email or '‚Äî' }}</td>
                        <td>
                            {% if nv.ChucVu %}
                            <span class="badge bg-secondary">{{ nv.ChucVu }}</span>
                            {% else %} ‚Äî {% endif %}
                        </td>
                        <td>{{ nv.TenPB or '‚Äî' }}</td>
                        <td class="text-center">
                            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c t·ª´ng nh√¢n vi√™n -->
                            <a href="{{ url_for('employee_bp.restore_employee', ma_nv=nv.MaNV) }}" 
                               class="btn btn-success btn-sm"
                               onclick="return confirm('Kh√¥i ph·ª•c nh√¢n vi√™n {{ nv.HoTen }}?')">
                                <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ Thanh kh√¥i ph·ª•c nhi·ªÅu -->
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="text-muted">
                <span id="selected-count-employees">0</span> nh√¢n vi√™n ƒë∆∞·ª£c ch·ªçn
            </div>
            <button type="submit" id="restore-selected-employees-btn" class="btn btn-success" disabled
                onclick="return confirm('Kh√¥i ph·ª•c c√°c nh√¢n vi√™n ƒë√£ ch·ªçn?')">
                <i class="fas fa-rotate-left me-2"></i>Kh√¥i ph·ª•c ƒë√£ ch·ªçn
            </button>
        </div>
    </form>

    {% else %}
    <div class="empty-state text-center py-5">
        <div class="empty-icon mb-3"><i class="fas fa-user-slash fa-3x text-muted"></i></div>
        <h4 class="empty-title">Kh√¥ng c√≥ nh√¢n vi√™n n√†o ƒë√£ x√≥a</h4>
        <p class="text-muted">T·∫•t c·∫£ nh√¢n vi√™n ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng. Nh√¢n vi√™n b·ªã x√≥a s·∫Ω xu·∫•t hi·ªán t·∫°i ƒë√¢y.</p>
        <a href="{{ url_for('employee_bp.employee_list') }}" class="btn btn-primary">
            <i class="fas fa-users me-2"></i>Qu·∫£n l√Ω nh√¢n vi√™n
        </a>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- ‚úÖ Script ch·ªçn checkbox h√†ng lo·∫°t -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const selectAll = document.getElementById("select-all-employees");
    const checkboxes = document.querySelectorAll(".employee-checkbox");
    const countLabel = document.getElementById("selected-count-employees");
    const restoreBtn = document.getElementById("restore-selected-employees-btn");

    function updateCount() {
        const count = document.querySelectorAll(".employee-checkbox:checked").length;
        countLabel.textContent = count;
        restoreBtn.disabled = count === 0;
    }

    if (selectAll) {
        selectAll.addEventListener("change", function() {
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateCount();
        });
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
});
</script>


<!-- Tab ph√≤ng ban -->
{% if active_tab == 'departments' %}
<div class="tab-pane fade show active">
    {% if deleted_departments %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0"><i class="fas fa-building text-danger me-2"></i>Ph√≤ng ban ƒë√£ x√≥a</h4>
            <p class="text-muted mb-0 mt-1">T·ªïng c·ªông: {{ deleted_departments|length }} ph√≤ng ban</p>
        </div>
        <a href="{{ url_for('department_bp.departments') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch ph√≤ng ban
        </a>
    </div>

    <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu -->
    <form method="POST" action="{{ url_for('department_bp.restore_multiple_departments') }}">
        <div class="table-container">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" id="select-all-departments" class="form-check-input">
                        </th>
                        <th>M√£ PB</th>
                        <th>T√™n ph√≤ng ban</th>
                        <th>Qu·∫£n l√Ω</th>
                        <th>S·ªë nh√¢n vi√™n</th>
                        <th class="text-center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pb in deleted_departments %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_departments" value="{{ pb.MaPB }}" class="form-check-input department-checkbox">
                        </td>
                        <td class="fw-bold">{{ pb.MaPB }}</td>
                        <td>{{ pb.TenPB }}</td>
                        <td>{{ pb.QuanLy or '‚Äî' }}</td>
                        <td>{{ pb.SoNhanVien or 0 }}</td>
                        <td class="text-center">
                            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c t·ª´ng ph√≤ng ban -->
                            <form method="POST" action="{{ url_for('department_bp.restore_department', ma_pb=pb.MaPB) }}" style="display:inline;">
                                <button type="submit" class="btn btn-success btn-sm"
                                        onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën kh√¥i ph·ª•c ph√≤ng ban {{ pb.TenPB }}?')">
                                    <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ H√†nh ƒë·ªông nh√≥m -->
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="text-muted"><span id="selected-count-departments">0</span> ph√≤ng ban ƒë∆∞·ª£c ch·ªçn</div>
            <button type="submit" id="restore-selected-departments-btn" class="btn btn-success" disabled
                onclick="return confirm('Kh√¥i ph·ª•c c√°c ph√≤ng ban ƒë√£ ch·ªçn?')">
                <i class="fas fa-rotate-left me-2"></i>Kh√¥i ph·ª•c ƒë√£ ch·ªçn
            </button>
        </div>
    </form>

    {% else %}
    <div class="empty-state">
        <div class="empty-icon"><i class="fas fa-building"></i></div>
        <h3 class="empty-title">Kh√¥ng c√≥ ph√≤ng ban n√†o ƒë√£ x√≥a</h3>
        <p class="empty-text">T·∫•t c·∫£ ph√≤ng ban ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng. Ph√≤ng ban b·ªã x√≥a s·∫Ω xu·∫•t hi·ªán t·∫°i ƒë√¢y.</p>
        <a href="{{ url_for('department_bp.departments') }}" class="btn btn-primary">
            <i class="fas fa-building me-2"></i>Qu·∫£n l√Ω ph√≤ng ban
        </a>
    </div>
    {% endif %}
</div>
{% endif %}

<script>
document.addEventListener("DOMContentLoaded", function() {
    const selectAll = document.getElementById("select-all-departments");
    const checkboxes = document.querySelectorAll(".department-checkbox");
    const countLabel = document.getElementById("selected-count-departments");
    const restoreBtn = document.getElementById("restore-selected-departments-btn");

    function updateCount() {
        const count = document.querySelectorAll(".department-checkbox:checked").length;
        countLabel.textContent = count;
        restoreBtn.disabled = count === 0;
    }

    if (selectAll) {
        selectAll.addEventListener("change", function() {
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateCount();
        });
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
});
</script>

{% if active_tab == 'shifts' %}
<div class="tab-pane fade show active">
    {% if deleted_shifts %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0"><i class="fas fa-clock text-danger me-2"></i>Ca l√†m vi·ªác ƒë√£ ng∆∞ng ho·∫°t ƒë·ªông</h4>
            <p class="text-muted mb-0 mt-1">T·ªïng c·ªông: {{ deleted_shifts|length }} ca l√†m vi·ªác</p>
        </div>
        <a href="{{ url_for('shift_bp.shifts') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch ca l√†m vi·ªác
        </a>
    </div>

    <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu ca -->
    <form method="POST" action="{{ url_for('shift_bp.restore_shift') }}">
        <div class="table-container">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" id="select-all-shifts" class="form-check-input">
                        </th>
                        <th>M√£ ca</th>
                        <th>T√™n ca</th>
                        <th>Gi·ªù b·∫Øt ƒë·∫ßu</th>
                        <th>Gi·ªù k·∫øt th√∫c</th>
                        <th>H·ªá s·ªë</th>
                        <th>Ng√†y c·∫≠p nh·∫≠t</th>
                        <th class="text-center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ca in deleted_shifts %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_ids" value="{{ ca.MaCa }}" class="form-check-input shift-checkbox">
                        </td>
                        <td class="fw-bold">{{ ca.MaCa }}</td>
                        <td>{{ ca.TenCa }}</td>
                        <td>
                            {% if ca.GioBatDau %}
                                {{ ca.GioBatDau[:5] if ca.GioBatDau is string else ca.GioBatDau.strftime("%H:%M") }}
                            {% else %} ‚Äî {% endif %}
                        </td>
                        <td>
                            {% if ca.GioKetThuc %}
                                {{ ca.GioKetThuc[:5] if ca.GioKetThuc is string else ca.GioKetThuc.strftime("%H:%M") }}
                            {% else %} ‚Äî {% endif %}
                        </td>
                        <td>{{ ca.HeSo }}</td>
                        <td>{{ ca.NgayCapNhat.strftime("%d/%m/%Y") if ca.NgayCapNhat else "‚Äî" }}</td>
                        <td class="text-center">
                            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c t·ª´ng ca -->
                            <form method="POST" action="{{ url_for('shift_bp.restore_shift') }}" style="display:inline;">
                                <input type="hidden" name="selected_ids" value="{{ ca.MaCa }}">
                                <button type="submit" class="btn btn-success btn-sm"
                                    onclick="return confirm('Kh√¥i ph·ª•c ca {{ ca.TenCa }}?')">
                                    <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ H√†nh ƒë·ªông nh√≥m -->
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="text-muted">
                <span id="selected-count-shifts">0</span> ca l√†m vi·ªác ƒë∆∞·ª£c ch·ªçn
            </div>
            <button type="submit" id="restore-selected-shifts-btn" class="btn btn-success" disabled
                onclick="return confirm('Kh√¥i ph·ª•c c√°c ca l√†m vi·ªác ƒë√£ ch·ªçn?')">
                <i class="fas fa-rotate-left me-2"></i>Kh√¥i ph·ª•c ƒë√£ ch·ªçn
            </button>
        </div>
    </form>

    {% else %}
    <div class="empty-state text-center">
        <div class="empty-icon"><i class="fas fa-clock"></i></div>
        <h3 class="empty-title">Kh√¥ng c√≥ ca l√†m vi·ªác n√†o ƒë√£ ng∆∞ng ho·∫°t ƒë·ªông</h3>
        <p class="empty-text">T·∫•t c·∫£ ca l√†m vi·ªác ƒë·ªÅu ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.</p>
        <a href="{{ url_for('shift_bp.shifts') }}" class="btn btn-primary">
            <i class="fas fa-clock me-2"></i>Qu·∫£n l√Ω ca l√†m vi·ªác
        </a>
    </div>
    {% endif %}
</div>
{% endif %}

<script>
document.addEventListener("DOMContentLoaded", function() {
    const selectAll = document.getElementById("select-all-shifts");
    const checkboxes = document.querySelectorAll(".shift-checkbox");
    const countLabel = document.getElementById("selected-count-shifts");
    const restoreBtn = document.getElementById("restore-selected-shifts-btn");

    function updateCount() {
        const count = document.querySelectorAll(".shift-checkbox:checked").length;
        countLabel.textContent = count;
        restoreBtn.disabled = count === 0;
    }

    if (selectAll) {
        selectAll.addEventListener("change", function() {
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateCount();
        });
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
});
</script>

{% if active_tab == 'schedule_bp.shift_assignments' %}
<div class="tab-pane fade show active">
    {% if deleted_shift_assignments %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0"><i class="fas fa-calendar-times text-danger me-2"></i>Ph√¢n ca ƒë√£ x√≥a</h4>
            <p class="text-muted mb-0 mt-1">
                T·ªïng c·ªông: {{ deleted_shift_assignments|length }} ph√¢n ca
            </p>
        </div>
        <a href="{{ url_for('schedule_bp.assigned_employees') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch ph√¢n ca
        </a>
    </div>

    <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu -->
    <form method="POST" action="{{ url_for('schedule_bp.restore_multiple_shift_assignments') }}">
        <div class="table-container">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" id="select-all-shift-assignments" class="form-check-input">
                        </th>
                        <th>M√£ LLV</th>
                        <th>M√£ NV</th>
                        <th>H·ªç t√™n</th>
                        <th>Ng√†y l√†m</th>
                        <th>Ca l√†m</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th class="text-center">H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    {% for shift in deleted_shift_assignments %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_assignments"
                                   value="{{ shift.MaLLV }}" class="form-check-input shift-assignment-checkbox">
                        </td>
                        <td class="fw-bold">{{ shift.MaLLV }}</td>
                        <td>{{ shift.MaNV }}</td>
                        <td>{{ shift.HoTen or 'Kh√¥ng r√µ' }}</td>
                        <td>{{ shift.NgayLam[:10] if shift.NgayLam else '‚Äî' }}</td>
                        <td>{{ shift.TenCa or shift.MaCa }}</td>
                        <td>
                            {% if shift.TrangThai == 1 %}
                                <span class="badge bg-success">ƒê√£ ch·∫•m c√¥ng</span>
                            {% elif shift.TrangThai == 2 %}
                                <span class="badge bg-danger">V·∫Øng</span>
                            {% else %}
                                <span class="badge bg-secondary">Ch∆∞a ch·∫•m c√¥ng</span>
                            {% endif %}
                        </td>
                        <td class="text-center">
                            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c t·ª´ng b·∫£n ghi -->
                            <form method="POST"
                                  action="{{ url_for('schedule_bp.restore_shift_assignment', id=shift.MaLLV) }}"
                                  style="display:inline;">
                                <button type="submit" class="btn btn-success btn-sm"
                                    onclick="return confirm('Kh√¥i ph·ª•c ph√¢n ca c·ªßa {{ shift.HoTen }} ng√†y {{ shift.NgayLam[:10] if shift.NgayLam else '' }}?')">
                                    <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ Thanh kh√¥i ph·ª•c nh√≥m -->
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="text-muted">
                <span id="selected-count-shift-assignments">0</span> ph√¢n ca ƒë∆∞·ª£c ch·ªçn
            </div>
            <button type="submit" id="restore-selected-shift-assignments-btn"
                    class="btn btn-success" disabled
                    onclick="return confirm('Kh√¥i ph·ª•c c√°c ph√¢n ca ƒë√£ ch·ªçn?')">
                <i class="fas fa-rotate-left me-2"></i>Kh√¥i ph·ª•c ƒë√£ ch·ªçn
            </button>
        </div>
    </form>

    {% else %}
    <div class="empty-state text-center">
        <div class="empty-icon"><i class="fas fa-calendar-times"></i></div>
        <h3 class="empty-title">Kh√¥ng c√≥ ph√¢n ca n√†o ƒë√£ x√≥a</h3>
        <p class="text-muted">T·∫•t c·∫£ ph√¢n ca ƒë·ªÅu ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.</p>
        <a href="{{ url_for('schedule_bp.assigned_employees') }}" class="btn btn-primary">
            <i class="fas fa-calendar-check me-2"></i>Qu·∫£n l√Ω ph√¢n ca
        </a>
    </div>
    {% endif %}
</div>
{% endif %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const selectAll = document.getElementById("select-all-shift-assignments");
    const checkboxes = document.querySelectorAll(".shift-assignment-checkbox");
    const countLabel = document.getElementById("selected-count-shift-assignments");
    const restoreBtn = document.getElementById("restore-selected-shift-assignments-btn");

    function updateCount() {
        const count = document.querySelectorAll(".shift-assignment-checkbox:checked").length;
        countLabel.textContent = count;
        restoreBtn.disabled = count === 0;
    }

    if (selectAll) {
        selectAll.addEventListener("change", function() {
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateCount();
        });
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
});
</script>


<!-- ================= TAB CH·∫§M C√îNG ================= -->
{% if active_tab == 'attendance' %}
<div class="tab-pane fade show active" id="attendance-tab">
    {% if deleted_attendance %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0">
                <i class="fas fa-user-clock text-danger me-2"></i>
                Ch·∫•m c√¥ng ƒë√£ x√≥a
            </h4>
            <p class="text-muted mb-0 mt-1">
                T·ªïng c·ªông: {{ deleted_attendance|length }} b·∫£n ghi
            </p>
        </div>
        <a href="{{ url_for('attendance_bp.attendance_report') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch ch·∫•m c√¥ng
        </a>
    </div>

    <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu -->
    <form method="POST" action="{{ url_for('attendance_bp.restore_multiple_attendance') }}">
        <div class="table-container">
            <table class="table table-hover align-middle text-center">
                <thead class="table-light">
                    <tr>
                        <th><input type="checkbox" id="select-all" class="form-check-input"></th>
                        <th>M√£ NV</th>
                        <th>H·ªç t√™n</th>
                        <th>Ph√≤ng ban</th>
                        <th>Ng√†y</th>
                        <th>Ca l√†m</th>
                        <th>Gi·ªù v√†o</th>
                        <th>Gi·ªù ra</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    {% for r in deleted_attendance %}
                    <tr>
                        <!-- Checkbox -->
                        <td>
                            <input type="checkbox" name="selected_ids"
                                   value="{{ r.MaChamCong }}"
                                   class="form-check-input record-checkbox">
                        </td>

                        <!-- M√£ NV -->
                        <td class="fw-bold text-primary">
                            {{ r.MaNV or '‚Äî' }}
                        </td>

                        <!-- H·ªç t√™n -->
                        <td>{{ r.HoTen or 'Kh√¥ng r√µ' }}</td>

                        <!-- Ph√≤ng ban -->
                        <td>{{ r.TenPB or '‚Äî' }}</td>

                        <!-- Ng√†y -->
                        <td>{{ r.NgayChamCong[:10] if r.NgayChamCong else '‚Äî' }}</td>

                        <!-- Ca l√†m -->
                        <td>{{ r.TenCa or '‚Äî' }}</td>

                        <!-- Gi·ªù v√†o -->
                        <td>
                            {% if r.GioVao %}
                                {{ r.GioVao.replace('1900-01-01', '').strip() }}
                            {% else %}‚Äî{% endif %}
                        </td>

                        <!-- Gi·ªù ra -->
                        <td>
                            {% if r.GioRa %}
                                {{ r.GioRa.replace('1900-01-01', '').strip() }}
                            {% else %}‚Äî{% endif %}
                        </td>

                        <!-- Tr·∫°ng th√°i -->
                        <td>
                            {% set trang_thai = r.TrangThai|int %}
                            {% if trang_thai == 1 %}
                                <span class="badge bg-success px-3 py-2">ƒê√∫ng gi·ªù</span>
                            {% elif trang_thai == 2 %}
                                <span class="badge bg-warning text-dark px-3 py-2">ƒêi mu·ªôn</span>
                            {% elif trang_thai == 0 %}
                                <span class="badge bg-danger px-3 py-2">V·∫Øng</span>
                            {% else %}
                                <span class="badge bg-secondary px-3 py-2">Kh√¥ng x√°c ƒë·ªãnh</span>
                            {% endif %}
                        </td>

                        <!-- H√†nh ƒë·ªông -->
                        <td>
                            <button type="submit"
                                    formaction="{{ url_for('attendance_bp.restore_attendance', id=r.MaChamCong) }}"
                                    class="btn btn-success btn-sm"
                                    onclick="return confirm('Kh√¥i ph·ª•c b·∫£n ghi c·ªßa {{ r.HoTen }} ng√†y {{ r.NgayChamCong[:10] if r.NgayChamCong else '' }}?')">
                                <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ Bulk action -->
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="text-muted">
                <span id="selected-count">0</span> b·∫£n ghi ƒë∆∞·ª£c ch·ªçn
            </div>
            <button type="submit" class="btn btn-success" id="restore-selected-btn" disabled
                    onclick="return confirm('Kh√¥i ph·ª•c c√°c b·∫£n ghi ch·∫•m c√¥ng ƒë√£ ch·ªçn?')">
                <i class="fas fa-rotate-left me-2"></i> Kh√¥i ph·ª•c ƒë√£ ch·ªçn
            </button>
        </div>
    </form>

    {% else %}
    <div class="empty-state text-center mt-4">
        <div class="empty-icon">
            <i class="fas fa-user-clock fa-2x text-muted mb-3"></i>
        </div>
        <h5 class="empty-title">Kh√¥ng c√≥ b·∫£n ghi ch·∫•m c√¥ng n√†o ƒë√£ x√≥a</h5>
        <p class="text-muted">T·∫•t c·∫£ b·∫£n ghi ch·∫•m c√¥ng ƒë·ªÅu ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.</p>
        <a href="{{ url_for('attendance_bp.attendance_report') }}" class="btn btn-primary">
            <i class="fas fa-user-check me-2"></i> Qu·∫£n l√Ω ch·∫•m c√¥ng
        </a>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- Tab t√†i kho·∫£n -->
{% if active_tab == 'accounts' %}
<div class="tab-pane fade show active">
    {% if deleted_accounts %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-0">
                <i class="fas fa-user-gear text-danger me-2"></i>
                T√†i kho·∫£n ƒë√£ v√¥ hi·ªáu h√≥a
            </h4>
            <p class="text-muted mb-0 mt-1">
                T·ªïng c·ªông: {{ deleted_accounts|length }} t√†i kho·∫£n
            </p>
        </div>
        <a href="{{ url_for('account_bp.accounts') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch t√†i kho·∫£n
        </a>
    </div>

    <!-- ‚úÖ Form ch√≠nh cho kh√¥i ph·ª•c nhi·ªÅu -->
    <form id="bulk-restore-form" method="POST" action="{{ url_for('account_bp.restore_multiple_accounts') }}">
        <div class="table-container">
            <table class="table table-hover align-middle">
                <thead>
                    <tr>
                        <th style="width:40px;">
                            <input type="checkbox" id="select-all-accounts" class="form-check-input">
                        </th>
                        <th>M√£ TK</th>
                        <th>T√™n ƒëƒÉng nh·∫≠p</th>
                        <th>H·ªç t√™n</th>
                        <th>Vai tr√≤</th>
                        <th>Ng√†y t·∫°o</th>
                        <th class="text-center">H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    {% for acc in deleted_accounts %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_accounts"
                                   value="{{ acc.TenDangNhap }}" class="form-check-input account-checkbox">
                        </td>
                        <td class="fw-bold">{{ acc.MaTK }}</td>
                        <td>{{ acc.TenDangNhap }}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="user-avatar me-2" style="width:35px;height:35px;font-size:0.9rem;">
                                    {{ acc.HoTen[0]|upper if acc.HoTen else 'U' }}
                                </div>
                                {{ acc.HoTen or 'Kh√¥ng r√µ' }}
                            </div>
                        </td>
                        <td>
                            {% if acc.VaiTro == 'admin' %}
                                <span class="badge bg-danger">Qu·∫£n tr·ªã</span>
                            {% elif acc.VaiTro == 'manager' %}
                                <span class="badge bg-warning text-dark">Qu·∫£n l√Ω</span>
                            {% else %}
                                <span class="badge bg-secondary">Nh√¢n vi√™n</span>
                            {% endif %}
                        </td>
                        <td>{{ acc.NgayTao.strftime("%d/%m/%Y") if acc.NgayTao else "‚Äî" }}</td>
                        <td class="text-center">
                            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c 1 t√†i kho·∫£n (ch·∫°y JS ƒë·ªÉ tr√°nh l·ªìng form) -->
                            <button type="button" class="btn btn-success btn-sm"
                                    onclick="restoreSingle('{{ acc.TenDangNhap }}')">
                                <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- ‚úÖ Thanh kh√¥i ph·ª•c nh√≥m -->
<div class="d-flex justify-content-between align-items-center mt-3">
    <div class="text-muted">
        <span id="selected-count-accounts">0</span> t√†i kho·∫£n ƒë∆∞·ª£c ch·ªçn
    </div>

    <!-- ‚úÖ ƒê·∫∑t form="bulk-restore-form" ƒë·ªÉ ch·∫Øc ch·∫Øn li√™n k·∫øt ƒë√∫ng -->
    <button type="submit"
            form="bulk-restore-form"
            id="restore-selected-accounts-btn"
            class="btn btn-success"
            disabled
            onclick="return confirm('Kh√¥i ph·ª•c c√°c t√†i kho·∫£n ƒë√£ ch·ªçn?')">
        <i class="fas fa-rotate-left me-2"></i>Kh√¥i ph·ª•c ƒë√£ ch·ªçn
    </button>
</div>

    </form>

    <!-- ‚úÖ Form ·∫©n ri√™ng ƒë·ªÉ kh√¥i ph·ª•c 1 t√†i kho·∫£n -->
    <form id="single-restore-form" method="POST" style="display:none;"></form>

    <!-- üß† Script -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const selectAll = document.getElementById("select-all-accounts");
        const checkboxes = document.querySelectorAll(".account-checkbox");
        const countLabel = document.getElementById("selected-count-accounts");
        const restoreBtn = document.getElementById("restore-selected-accounts-btn");

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng checkbox ƒë∆∞·ª£c ch·ªçn
        function updateCount() {
            const count = document.querySelectorAll(".account-checkbox:checked").length;
            countLabel.textContent = count;
            restoreBtn.disabled = count === 0;
        }

        if (selectAll) {
            selectAll.addEventListener("change", function() {
                checkboxes.forEach(cb => cb.checked = selectAll.checked);
                updateCount();
            });
        }

        checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
    });

    // ‚úÖ H√†m kh√¥i ph·ª•c 1 t√†i kho·∫£n
    function restoreSingle(username) {
        if (!confirm('Kh√¥i ph·ª•c t√†i kho·∫£n ' + username + '?')) return;
        const form = document.getElementById("single-restore-form");
        form.action = `/accounts/activate/${username}`;
        form.submit();
    }
    </script>

    {% else %}
    <div class="empty-state text-center">
        <div class="empty-icon"><i class="fas fa-user-gear"></i></div>
        <h3 class="empty-title">Kh√¥ng c√≥ t√†i kho·∫£n n√†o ƒë√£ v√¥ hi·ªáu</h3>
        <p class="text-muted">T·∫•t c·∫£ t√†i kho·∫£n ƒë·ªÅu ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.</p>
        <a href="{{ url_for('account_bp.accounts') }}" class="btn btn-primary">
            <i class="fas fa-user-gear me-2"></i>Qu·∫£n l√Ω t√†i kho·∫£n
        </a>
    </div>
    {% endif %}
</div>
{% endif %}


<!-- ==================== TAB L∆Ø∆†NG ==================== -->
<div
  class="tab-pane fade {% if active_tab == 'salaries' %}show active{% endif %}"
  id="tab-salaries"
>
  {% if deleted_salaries and deleted_salaries|length > 0 %}
  <!-- ‚úÖ C√≥ d·ªØ li·ªáu -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h4 class="mb-0">
        <i class="fas fa-coins text-danger me-2"></i> L∆∞∆°ng ƒë√£ x√≥a m·ªÅm
      </h4>
      <p class="text-muted mb-0 mt-1">
        T·ªïng c·ªông: {{ deleted_salaries|length }} b·∫£n ghi
      </p>
    </div>
    <a href="{{ url_for('salary_bp.salary_view') }}" class="btn btn-primary">
      <i class="fas fa-arrow-left me-2"></i> Quay l·∫°i danh s√°ch l∆∞∆°ng
    </a>
  </div>

  <!-- ‚úÖ Form kh√¥i ph·ª•c nhi·ªÅu -->
  <form method="POST" action="{{ url_for('salary_bp.restore_multiple_salaries') }}">
    <div class="table-responsive shadow-sm rounded">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th style="width: 40px;">
              <input
                type="checkbox"
                id="select-all-salaries"
                class="form-check-input"
              />
            </th>
            <th>M√£ l∆∞∆°ng</th>
            <th>M√£ NV</th>
            <th>H·ªç t√™n</th>
            <th>Ph√≤ng ban</th>
            <th>Th√°ng</th>
            <th>S·ªë gi·ªù l√†m</th>
            <th>T·ªïng ti·ªÅn (VND)</th>
            <th class="text-center">H√†nh ƒë·ªông</th>
          </tr>
        </thead>
        <tbody>
          {% for l in deleted_salaries %}
          <tr>
            <td>
              <input
                type="checkbox"
                name="selected_salaries"
                value="{{ l.MaLuong }}"
                class="form-check-input salary-checkbox"
              />
            </td>
            <td class="fw-bold text-primary">{{ l.MaLuong }}</td>
            <td>{{ l.MaNV }}</td>
            <td>{{ l.HoTen }}</td>
            <td>{{ l.TenPB or '‚Äî' }}</td>

            <!-- ‚úÖ Hi·ªÉn th·ªã Th√°ng/NƒÉm -->
            <td>
              {% if l.ThangNam %}
                {{ l.ThangNam[:7].replace('-', '/') }}
              {% else %}
                ‚Äî
              {% endif %}
            </td>

            <td>{{ "%.2f"|format(l.SoGioLam or 0) }}</td>
            <td>{{ "{:,.0f}".format(l.TongTien or 0) }}</td>

            <!-- ‚úÖ N√∫t kh√¥i ph·ª•c -->
            <td class="text-center">
              <button
                type="submit"
                name="selected_salaries"
                value="{{ l.MaLuong }}"
                class="btn btn-success btn-sm"
                onclick="return confirm('Kh√¥i ph·ª•c b·∫£n ghi l∆∞∆°ng c·ªßa {{ l.HoTen }} th√°ng {{ l.ThangNam[:7].replace('-', '/') if l.ThangNam else '' }}?')"
              >
                <i class="fas fa-rotate-left me-1"></i> Kh√¥i ph·ª•c
              </button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- ‚úÖ Thanh h√†nh ƒë·ªông nh√≥m -->
    <div class="d-flex justify-content-between align-items-center mt-3">
      <div class="text-muted">
        <span id="selected-count-salaries">0</span> b·∫£n ghi ƒë∆∞·ª£c ch·ªçn
      </div>
      <button
        type="submit"
        id="restore-selected-salaries-btn"
        class="btn btn-success"
        disabled
        onclick="return confirm('Kh√¥i ph·ª•c c√°c b·∫£n ghi l∆∞∆°ng ƒë√£ ch·ªçn?')"
      >
        <i class="fas fa-rotate-left me-2"></i> Kh√¥i ph·ª•c ƒë√£ ch·ªçn
      </button>
    </div>
  </form>

  {% else %}
  <!-- ‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu -->
  <div class="empty-state text-center py-5">
    <div class="empty-icon mb-3">
      <i class="fas fa-coins fa-3x text-secondary"></i>
    </div>
    <h4 class="empty-title mb-2">Kh√¥ng c√≥ b·∫£n ghi l∆∞∆°ng n√†o ƒë√£ x√≥a</h4>
    <p class="text-muted mb-4">
      T·∫•t c·∫£ b·∫£n ghi l∆∞∆°ng hi·ªán ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.
    </p>
    <a href="{{ url_for('salary_bp.salary_view') }}" class="btn btn-primary">
      <i class="fas fa-coins me-2"></i> Qu·∫£n l√Ω l∆∞∆°ng
    </a>
  </div>
  {% endif %}
</div>

<!-- ==================== SCRIPT ==================== -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const selectAll = document.getElementById("select-all-salaries");
  const checkboxes = document.querySelectorAll(".salary-checkbox");
  const countLabel = document.getElementById("selected-count-salaries");
  const restoreBtn = document.getElementById("restore-selected-salaries-btn");

  function updateCount() {
    const count = document.querySelectorAll(".salary-checkbox:checked").length;
    if (countLabel) countLabel.textContent = count;
    if (restoreBtn) restoreBtn.disabled = count === 0;
  }

  if (selectAll) {
    selectAll.addEventListener("change", function () {
      checkboxes.forEach((cb) => (cb.checked = selectAll.checked));
      updateCount();
    });
  }

  checkboxes.forEach((cb) => cb.addEventListener("change", updateCount));
});
</script>


<!-- ==================== TAB KHU√îN M·∫∂T ==================== -->
{% if active_tab == 'faces' %}
<div class="tab-pane fade show active">
    {% if deleted_faces %}
        <div class="row g-4 justify-content-start">
            {% for face in deleted_faces %}
            <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center">
                <div class="card border-0 shadow-sm rounded-3">
                    <div class="card-body p-2">
                        {% if face.DuongDanAnh %}
                            <img src="{{ '/photos/' + face.DuongDanAnh.split('/')[-1] }}"
                                 alt="·∫¢nh khu√¥n m·∫∑t"
                                 class="img-fluid rounded-circle border mb-2"
                                 style="width:110px; height:110px; object-fit:cover;">
                        {% else %}
                            <div class="rounded-circle bg-light d-flex align-items-center justify-content-center border mb-2"
                                 style="width:110px; height:110px;">
                                <i class="fas fa-user text-muted fa-2x"></i>
                            </div>
                        {% endif %}
                        <h6 class="fw-semibold mb-0">{{ face.HoTen or "Kh√¥ng r√µ" }}</h6>
                        <small class="text-muted">{{ face.TenPB or "‚Äî" }}</small>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-5">
            <i class="fas fa-face-smile fa-3x text-primary mb-3"></i>
            <h5>Kh√¥ng c√≥ khu√¥n m·∫∑t n√†o ƒë√£ x√≥a</h5>
            <p class="text-muted">T·∫•t c·∫£ khu√¥n m·∫∑t hi·ªán ƒëang ho·∫°t ƒë·ªông trong h·ªá th·ªëng.</p>
            <a href="{{ url_for('faces_bp.faces') }}" class="btn btn-primary mt-3">
                <i class="fas fa-arrow-left me-2"></i>Qu·∫£n l√Ω khu√¥n m·∫∑t
            </a>
        </div>
    {% endif %}
</div>
{% endif %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
document.addEventListener("DOMContentLoaded", function() {
    const selectAll = document.getElementById("select-all");
    const checkboxes = document.querySelectorAll(".record-checkbox");
    const selectedCount = document.getElementById("selected-count");
    const restoreBtn = document.getElementById("restore-selected-btn");

    function updateCount() {
        const count = document.querySelectorAll(".record-checkbox:checked").length;
        selectedCount.textContent = count;
        restoreBtn.disabled = count === 0;
    }

    if (selectAll) {
        selectAll.addEventListener("change", function() {
            checkboxes.forEach(cb => cb.checked = selectAll.checked);
            updateCount();
        });
    }

    checkboxes.forEach(cb => cb.addEventListener("change", updateCount));
});
</script>

</body>
</html>