<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lịch sử chấm công - FaceID</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary:#2563EB; --secondary:#10B981; --accent:#8B5CF6; 
            --light:#F9FAFB; --gray:#6B7280; --dark:#1F2937; 
            --gradient-primary:linear-gradient(135deg,var(--primary),var(--accent));
        }
        body { font-family:'Inter',sans-serif; background:var(--light); color:var(--dark); padding:20px; }
        .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:30px; padding-bottom:15px; border-bottom:2px solid var(--primary); }
        .logo { display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--dark); font-weight:700; font-size:1.5rem; }
        .logo-icon { width:40px; height:40px; border-radius:10px; display:flex; align-items:center; justify-content:center; background:var(--gradient-primary); color:#fff; }
        h1 { color:var(--dark); margin-bottom:25px; font-weight:700; background:var(--gradient-primary); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        .card { border:none; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,0.08); margin-bottom:20px; transition:transform 0.3s ease, box-shadow 0.3s ease; }
        .card:hover { transform:translateY(-5px); box-shadow:0 8px 25px rgba(0,0,0,0.15); }
        .card-header { background:var(--gradient-primary); color:#fff; border-radius:12px 12px 0 0 !important; font-weight:600; padding:15px 20px; }
        .table { margin-bottom:0; border-collapse:separate; border-spacing:0; }
        .table th { background-color:#f8f9fa; font-weight:600; text-transform:uppercase; font-size:0.85rem; border-bottom:2px solid var(--primary); padding:12px 15px; }
        .table td { padding:12px 15px; vertical-align:middle; border-bottom:1px solid #dee2e6; }
        .table-hover tbody tr { transition:background-color 0.2s ease; }
        .table-hover tbody tr:hover { background-color:rgba(37, 99, 235, 0.05); transform:scale(1.01); }
        .badge { font-size:0.75rem; padding:6px 12px; border-radius:20px; font-weight:600; }
        .badge-success { background:linear-gradient(135deg, var(--secondary), #059669) !important; color:white; }
        .badge-warning { background:linear-gradient(135deg, #f59e0b, #d97706) !important; color:white; }
        .badge-secondary { background:linear-gradient(135deg, var(--gray), #4b5563) !important; color:white; }
        .btn-back { background:var(--gradient-primary); border:none; color:#fff; padding:10px 20px; border-radius:8px; font-weight:600; transition:all 0.3s ease; display:inline-flex; align-items:center; gap:8px; text-decoration:none; }
        .btn-back:hover { opacity:0.9; transform:translateY(-2px); box-shadow:0 4px 8px rgba(37, 99, 235, 0.3); color:#fff; }
        .empty-state { text-align:center; padding:40px 20px; color:var(--gray); }
        .empty-state i { font-size:3rem; margin-bottom:15px; color:var(--gray); opacity:0.5; }
        .stats-card { background:var(--gradient-primary); color:white; border-radius:12px; padding:20px; margin-bottom:25px; transition:transform 0.3s ease; }
        .stats-card:hover { transform:translateY(-5px); }
        .stats-card h5 { font-size:0.9rem; opacity:0.9; margin-bottom:5px; display:flex; align-items:center; }
        .stats-card .number { font-size:1.8rem; font-weight:700; }
        @media (max-width:768px) {
            .header { flex-direction:column; gap:15px; text-align:center; }
            .table-responsive { border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); overflow:hidden; }
            .table thead { display:none; }
            .table, .table tbody, .table tr, .table td { display:block; width:100%; }
            .table tr { margin-bottom:15px; border:1px solid #ddd; border-radius:8px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.05); background:white; }
            .table td { text-align:right; padding-left:50%; position:relative; border:none; border-bottom:1px solid #f0f0f0; padding:10px 15px; }
            .table td:last-child { border-bottom:none; }
            .table td:before { content:attr(data-label); position:absolute; left:15px; width:45%; padding-right:10px; white-space:nowrap; text-align:left; font-weight:600; color:var(--primary); }
            .stats-grid { grid-template-columns:1fr !important; gap:15px !important; }
            .btn-back { width:100%; justify-content:center; }
        }
        .stats-grid { display:grid; grid-template-columns:repeat(3, 1fr); gap:20px; margin-bottom:25px; }
        .pagination { justify-content:center; margin-top:20px; }
        .page-link { color:var(--primary); border:1px solid #dee2e6; }
        .page-link:hover { color:var(--primary); background-color:#e9ecef; border-color:#dee2e6; }
        .page-item.active .page-link { background-color:var(--primary); border-color:var(--primary); }
        .filter-section { background:white; border-radius:12px; padding:20px; margin-bottom:25px; box-shadow:0 2px 10px rgba(0,0,0,0.08); }
        .filter-section h5 { margin-bottom:15px; color:var(--primary); font-weight:600; }
        .btn-filter { background:var(--gradient-primary); color:white; border:none; padding:8px 15px; border-radius:6px; transition:all 0.3s ease; }
        .btn-filter:hover { transform:translateY(-2px); box-shadow:0 4px 8px rgba(37, 99, 235, 0.3); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="{{ url_for('employee_dashboard') }}" class="logo">
                <div class="logo-icon"><i class="fas fa-id-badge"></i></div>
                <span>Face<span style="background:var(--gradient-primary);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">ID</span></span>
            </a>
            <a href="{{ url_for('logout') }}" class="btn btn-outline-primary btn-sm"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
        </div>

        <h1><i class="fas fa-clock me-2"></i>Lịch sử chấm công của bạn</h1>
        
        <!-- Bộ lọc -->
        <div class="filter-section">
            <h5><i class="fas fa-filter me-2"></i>Lọc kết quả</h5>
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Tháng</label>
                    <select class="form-select">
                        <option selected>Tất cả tháng</option>
                        <option>Tháng 1</option>
                        <option>Tháng 2</option>
                        <option>Tháng 3</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">Trạng thái</label>
                    <select class="form-select">
                        <option selected>Tất cả trạng thái</option>
                        <option>Đúng giờ</option>
                        <option>Đi muộn</option>
                        <option>Nghỉ làm</option>
                    </select>
                </div>
                <div class="col-md-4 d-flex align-items-end">
                    <button class="btn btn-filter w-100"><i class="fas fa-search me-2"></i>Áp dụng bộ lọc</button>
                </div>
            </div>
        </div>
        
        <!-- Thống kê nhanh -->
        {% if chamcong %}
        <div class="stats-grid">
            <div class="stats-card">
                <h5><i class="fas fa-check-circle me-2"></i>Đúng giờ</h5>
                <div class="number">{{ chamcong|selectattr("TrangThai", "equalto", 1)|list|length }}</div>
            </div>
            <div class="stats-card">
                <h5><i class="fas fa-exclamation-triangle me-2"></i>Đi muộn</h5>
                <div class="number">{{ chamcong|selectattr("TrangThai", "equalto", 2)|list|length }}</div>
            </div>
            <div class="stats-card">
                <h5><i class="fas fa-bed me-2"></i>Nghỉ làm</h5>
                <div class="number">{{ chamcong|selectattr("TrangThai", "equalto", 0)|list|length }}</div>
            </div>
        </div>
        {% endif %}
        
        {% if chamcong %}
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div><i class="fas fa-history me-2"></i>Tổng số bản ghi: {{ chamcong|length }}</div>
                <div class="text-white-50 small">Cập nhật lúc: {{ now.strftime('%H:%M %d/%m/%Y') if now else '--:-- --/--/----' }}</div>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Ngày chấm công</th>
                                <th>Giờ vào</th>
                                <th>Giờ ra</th>
                                <th>Trạng thái</th>
                                <th>Ghi chú</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for cc in chamcong %}
                            <tr>
                                <td data-label="Ngày chấm công">
                                    <div class="fw-bold">{{ cc.NgayChamCong }}</div>
                                    <small class="text-muted">{{ cc.Thu if cc.Thu else '' }}</small>
                                </td>
                                <td data-label="Giờ vào">
                                    {% if cc.GioVao %}
                                        <span class="fw-bold">{{ cc.GioVao }}</span>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </td>
                                <td data-label="Giờ ra">
                                    {% if cc.GioRa %}
                                        <span class="fw-bold">{{ cc.GioRa }}</span>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </td>
                                <td data-label="Trạng thái">
                                    {% if cc.TrangThai == 1 %}
                                        <span class="badge badge-success"><i class="fas fa-check me-1"></i>Đúng giờ</span>
                                    {% elif cc.TrangThai == 2 %}
                                        <span class="badge badge-warning"><i class="fas fa-clock me-1"></i>Muộn</span>
                                    {% else %}
                                        <span class="badge badge-secondary"><i class="fas fa-bed me-1"></i>Nghỉ</span>
                                    {% endif %}
                                </td>
                                <td data-label="Ghi chú">
                                    {% if cc.GhiChu %}
                                        <span class="text-muted small">{{ cc.GhiChu }}</span>
                                    {% else %}
                                        <span class="text-muted small">-</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Phân trang -->
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li class="page-item disabled"><a class="page-link" href="#">Trước</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">Tiếp</a></li>
            </ul>
        </nav>
        {% else %}
        <div class="empty-state">
            <i class="fas fa-clock"></i>
            <h3>Chưa có dữ liệu chấm công</h3>
            <p class="text-muted">Dữ liệu chấm công sẽ xuất hiện sau khi bạn thực hiện chấm công.</p>
            <a href="{{ url_for('employee_dashboard') }}" class="btn-back mt-3">
                <i class="fas fa-arrow-left"></i> Quay lại bảng điều khiển
            </a>
        </div>
        {% endif %}
        
        {% if chamcong %}
        <div class="d-flex justify-content-between align-items-center mt-4">
            <a href="{{ url_for('employee_dashboard') }}" class="btn-back">
                <i class="fas fa-arrow-left"></i> Quay lại bảng điều khiển
            </a>
            <button class="btn btn-outline-primary">
                <i class="fas fa-download me-2"></i> Xuất báo cáo
            </button>
        </div>
        {% endif %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Thêm hiệu ứng khi load trang
        document.addEventListener('DOMContentLoaded', function() {
            // Hiệu ứng cho stats card
            const statsCards = document.querySelectorAll('.stats-card');
            statsCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    card.style.transition = 'all 0.5s ease';
                    
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 50);
                }, index * 150);
            });
            
            // Hiệu ứng cho các hàng trong bảng
            const tableRows = document.querySelectorAll('.table tbody tr');
            tableRows.forEach((row, index) => {
                setTimeout(() => {
                    row.style.opacity = '0';
                    row.style.transform = 'translateX(-20px)';
                    row.style.transition = 'all 0.4s ease';
                    
                    setTimeout(() => {
                        row.style.opacity = '1';
                        row.style.transform = 'translateX(0)';
                    }, 50);
                }, index * 100);
            });
        });
    </script>
</body>
</html>